@use "sass:color"; // Importamos el módulo de color para las funciones modernas
@import "@ng-select/ng-select/themes/default.theme.css";

/* ================================
   PALETA DE COLORES MASTERSERV
   ================================ */

// Colores principales de la marca
$masterserv-primary: #E41E26;
$masterserv-white: #FFFFFF;
$masterserv-black: #121212;
$masterserv-gray-dark: #1E1E1E;
$masterserv-text: #E0E0E0;
$masterserv-metal: #9E9E9E;
$masterserv-accent: #FFC107;

// Variables de Bootstrap personalizadas
:root {
  --bs-primary: #{$masterserv-primary};
  --bs-secondary: #{$masterserv-metal};
  --bs-success: #28a745;
  --bs-info: #17a2b8;
  --bs-warning: #{$masterserv-accent};
  --bs-danger: #dc3545;
  --bs-light: #{$masterserv-text};
  --bs-dark: #{$masterserv-black};
  --bs-body-bg: #{$masterserv-black};
  --bs-body-color: #{$masterserv-text};
  --bs-card-bg: #{$masterserv-gray-dark};
  --bs-card-border-color: #{$masterserv-metal};
  --bs-input-bg: #{$masterserv-gray-dark};
  --bs-input-border-color: #{$masterserv-metal};
  --bs-input-color: #{$masterserv-white};
  --bs-heading-color: #{$masterserv-white};

  /* Definiendo explícitamente los colores de validación de formulario */
  --bs-form-valid-color: var(--bs-success);
  --bs-form-valid-border-color: var(--bs-success);
  --bs-form-invalid-color: var(--bs-danger);
  --bs-form-invalid-border-color: var(--bs-danger);
}

/* ================================
   ESTILOS GLOBALES MASTERSERV
   ================================ */

body {
  background-color: $masterserv-black;
  color: $masterserv-text;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  overflow-x: hidden;
}

/* Navbar personalizada */
.navbar-masterserv {
  background-color: $masterserv-black !important;
  border-bottom: 2px solid $masterserv-primary;
  
  .navbar-brand {
    color: $masterserv-primary !important;
    font-weight: bold;
    font-size: 1.5rem;
  }
  
  .nav-link {
    color: $masterserv-text !important;
    
    &:hover {
      color: $masterserv-primary !important;
    }
  }
}

/* Botones personalizados */
.btn-masterserv {
  background: linear-gradient(135deg, $masterserv-primary, color.adjust($masterserv-primary, $lightness: -10%));
  border: none;
  color: $masterserv-white;
  font-weight: 600;
  transition: all 0.3s ease;
  
  &:hover {
    background: linear-gradient(135deg, color.adjust($masterserv-primary, $lightness: 5%), $masterserv-primary);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba($masterserv-primary, 0.4);
    color: $masterserv-white;
  }
}

.btn-masterserv-accent {
  background: linear-gradient(135deg, $masterserv-accent, color.adjust($masterserv-accent, $lightness: -10%));
  border: none;
  color: $masterserv-black;
  font-weight: 600;
  
  &:hover {
    background: linear-gradient(135deg, color.adjust($masterserv-accent, $lightness: 5%), $masterserv-accent);
    color: $masterserv-black;
  }
}

/* Cards personalizadas */
.card-masterserv {
  background-color: $masterserv-gray-dark;
  border: 1px solid $masterserv-metal;
  border-radius: 8px;
  
  .card-header {
    background-color: rgba($masterserv-primary, 0.1);
    border-bottom: 1px solid $masterserv-metal;
    color: $masterserv-primary;
    font-weight: 600;
  }
  
  .card-title {
    color: $masterserv-white;
  }
}

/* Sidebar con nueva paleta */
/* Estas reglas se aplican a <app-sidebar> */
app-sidebar .sidebar {
  background: linear-gradient(180deg, $masterserv-black 0%, color.adjust($masterserv-black, $lightness: 5%) 100%);
  border-right: 1px solid $masterserv-metal;
  
  .sidebar-header {
    background-color: $masterserv-black;
    border-bottom: 1px solid $masterserv-primary;
    
    .brand {
      color: $masterserv-primary;
    }
    
    .brand-accent {
      color: $masterserv-accent;
    }
  }
  
  .menu a {
    color: $masterserv-text;
    border-left: 4px solid transparent;
    
    &:hover,
    &.active {
      background-color: rgba($masterserv-primary, 0.1);
      color: $masterserv-primary;
      border-left-color: $masterserv-primary;
    }
  }
  
  .menu-header span {
    color: $masterserv-accent;
  }
  
  .sidebar-footer {
    background-color: $masterserv-gray-dark;
    border-top: 1px solid $masterserv-metal;
    
    a {
      color: $masterserv-text !important;
      
      &:hover {
        background-color: rgba($masterserv-primary, 0.2);
        color: $masterserv-primary !important;
      }
    }
  }
}

/* Login con nueva paleta */
.login-container {
  background: $masterserv-black;
  
  .background-overlay {
    background: rgba($masterserv-black, 0.8);
  }
  
  .glass-card {
    background: rgba($masterserv-gray-dark, 0.95);
    border: 1px solid $masterserv-metal;
    
    .title-text {
      color: $masterserv-white;
    }
    
    .tagline {
      color: $masterserv-accent;
    }
  }
  
  .form-control-custom {
    background: rgba($masterserv-gray-dark, 0.8);
    border: 1px solid $masterserv-metal;
    color: $masterserv-text;
    
    &:focus {
      border-color: $masterserv-primary;
      box-shadow: 0 0 0 0.2rem rgba($masterserv-primary, 0.25);
    }
  }
  
  .btn-custom {
    background: linear-gradient(135deg, $masterserv-primary, color.adjust($masterserv-primary, $lightness: -10%));
    
    &:hover:not(:disabled) {
      background: linear-gradient(135deg, color.adjust($masterserv-primary, $lightness: 5%), $masterserv-primary);
    }
  }
}

/* Tablas personalizadas */
.table-masterserv {
  background-color: $masterserv-gray-dark;
  color: $masterserv-text; // Color por defecto (se aplica al tbody)
  
  thead {
    background-color: rgba($masterserv-primary, 0.1);
    
    th {
      color: $masterserv-primary;
      border-bottom: 2px solid $masterserv-metal;
    }
  }
  
  tbody, tbody tr, tbody td, tbody th {
    color: $masterserv-text !important; /* Forza el texto del <tbody> a ser claro */
    border-color: $masterserv-metal; /* Arregla los bordes de la fila */
  }

  tbody tr:hover {
    background-color: rgba($masterserv-primary, 0.05);
  }
}

/* Utilidades de color */
.text-masterserv { color: $masterserv-primary !important; }
.text-metal { color: $masterserv-metal !important; }
.text-accent { color: $masterserv-accent !important; }

.bg-masterserv { background-color: $masterserv-primary !important; }
.bg-dark-custom { background-color: $masterserv-gray-dark !important; }

.border-masterserv { border-color: $masterserv-primary !important; }
.border-metal { border-color: $masterserv-metal !important; }

/* Override de Bootstrap con la nueva paleta */
.card {
  background-color: $masterserv-gray-dark;
  border: 1px solid $masterserv-metal;
}

/* --- INICIO DE LA CORRECCIÓN DE FORMULARIOS --- */

.form-control {
  background-color: $masterserv-gray-dark;
  border: 1px solid $masterserv-metal;
  color: $masterserv-text; /* Color del texto que escribes */
  
  &:focus {
    background-color: $masterserv-gray-dark;
    border-color: $masterserv-primary;
    color: $masterserv-text;
    box-shadow: 0 0 0 0.2rem rgba($masterserv-primary, 0.25);
  }

  &::placeholder {
    color: #{$masterserv-metal};
    opacity: 0.7;
  }

  &:-webkit-autofill,
  &:-webkit-autofill:hover, 
  &:-webkit-autofill:focus, 
  &:-webkit-autofill:active  {
    -webkit-text-fill-color: $masterserv-text;
    -webkit-box-shadow: 0 0 0 30px $masterserv-gray-dark inset !important;
  }
}

.form-select {
  background-color: $masterserv-gray-dark;
  border: 1px solid $masterserv-metal;
  color: $masterserv-text;
  
  &:focus {
    background-color: $masterserv-gray-dark;
    border-color: $masterserv-primary;
    color: $masterserv-text;
    box-shadow: 0 0 0 0.2rem rgba($masterserv-primary, 0.25);
  }
}

.form-label {
  color: $masterserv-text;
}

.invalid-feedback {
  color: var(--bs-danger) !important;
}

.form-control.is-invalid, .form-select.is-invalid {
  border-color: var(--bs-danger) !important;
}

.card-subtitle {
  color: var(--bs-secondary) !important;
}

/* --- FIN DE LA CORRECCIÓN DE FORMULARIOS --- */


/* --- Mentor: INICIO DE ESTILOS GLOBALES PARA NG-SELECT (V3) --- */
.ng-dropdown-panel {
  background: $masterserv-gray-dark !important; /* Fondo del panel */
  border: 1px solid $masterserv-metal !important; /* Borde del panel */
  color: $masterserv-text !important; /* Color de texto general */
}

/* La fila/opción (contenedora) */
.ng-dropdown-panel .ng-option {
  background: $masterserv-gray-dark !important;
}

/* El contenido DENTRO de la opción (tu template) */
.ng-dropdown-panel .ng-option .ng-option-label,
.ng-dropdown-panel .ng-option .ng-option-label div {
  color: $masterserv-text !important; /* Texto claro (nombre del producto) */
  background: transparent !important;
}

/* **CORRECCIÓN CRÍTICA:** Color para el texto secundario (small/muted) */
.ng-dropdown-panel .ng-option .ng-option-label small {
  color: $masterserv-metal !important; /* Texto gris más oscuro para el código */
  background: transparent !important;
}

/* La fila/opción CUANDO ESTÁ SELECCIONADA (hover/focus) */
.ng-dropdown-panel .ng-option.ng-option-marked {
  background: $masterserv-primary !important; /* Fondo Rojo */
  color: $masterserv-white !important; /* Texto Blanco */
}

/* El contenido DENTRO de la opción SELECCIONADA (forzamos el blanco) */
.ng-dropdown-panel .ng-option.ng-option-marked .ng-option-label,
.ng-dropdown-panel .ng-option.ng-option-marked .ng-option-label div,
.ng-dropdown-panel .ng-option.ng-option-marked .ng-option-label small {
  color: $masterserv-white !important; /* Forzamos el texto a ser blanco en el hover */
  background: transparent !important;
}

.ng-dropdown-panel .ng-option-disabled {
  color: $masterserv-metal !important;
}
/* --- Mentor: FIN DE ESTILOS GLOBALES PARA NG-SELECT (V3) --- */


/* Responsive */
@media (max-width: 768px) {
  .sidebar {
    background: $masterserv-black;
  }
}

/* Efectos y animaciones */
@keyframes masterserv-glow {
  0%, 100% { box-shadow: 0 0 5px rgba($masterserv-primary, 0.5); }
  50% { box-shadow: 0 0 20px rgba($masterserv-primary, 0.8); }
}

.glow-effect {
  animation: masterserv-glow 2s ease-in-out infinite;
}

/* =========================================================
   LAYOUT GLOBAL DEL ADMIN & SIDEBAR RESPONSIVO
   (Esta es la única sección modificada para el menú móvil)
   ========================================================= */

/* 1. Botón Hamburguesa Flotante (Solo aparece en mobile por d-lg-none en HTML) */
.mobile-toggle-btn {
  position: fixed;
  top: 15px;
  left: 15px;
  z-index: 1050; /* Capa superior */
  background: $masterserv-primary; /* Usamos la variable */
  color: white;
  border: none;
  border-radius: 8px;
  width: 45px;
  height: 45px;
  font-size: 1.5rem;
  box-shadow: 0 4px 10px rgba(0,0,0,0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  cursor: pointer;
  
  &:active { transform: scale(0.95); }
}

/* 2. Sidebar Base (Desktop) */
app-sidebar {
  display: block;
  width: 260px; /* Ancho fijo como tenías */
  height: 100vh;
  position: fixed;
  left: 0;
  top: 0;
  z-index: 1040; /* Debajo del botón, encima del contenido */
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* 3. Contenido Principal Base (Desktop) */
.admin-container .content {
  margin-left: 260px; /* Deja espacio para el sidebar */
  width: calc(100% - 260px);
  padding: 20px;
  min-height: 100vh;
  box-sizing: border-box;
  transition: all 0.3s ease;
}

/* 4. Overlay (Fondo oscuro al abrir menú) */
.sidebar-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.6);
  z-index: 1030; /* Debajo del sidebar */
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  backdrop-filter: blur(2px);
}
.sidebar-overlay.show {
  opacity: 1;
  visibility: visible;
}

/* --- MEDIA QUERY: PANTALLAS MENORES A 992px (Tablets y Celulares) --- */
@media (max-width: 992px) {
  
  /* Sidebar oculto por defecto hacia la izquierda */
  app-sidebar {
    transform: translateX(-100%);
    box-shadow: none;
  }
  
  /* Cuando se activa la clase .mobile-open (desde TS) el sidebar entra */
  app-sidebar.mobile-open {
    transform: translateX(0);
    box-shadow: 5px 0 25px rgba(0,0,0,0.5);
  }

  /* El contenido ocupa el 100% del ancho (ya no hay margen izquierdo) */
  .admin-container .content {
    margin-left: 0;
    width: 100%;
    padding: 15px;
    padding-top: 80px; /* Dejamos espacio arriba para que el botón hamburguesa no tape nada */
  }
}